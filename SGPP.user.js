// ==UserScript==
// @name            Steamgifts++
// @namespace       https://github.com/faragona/SGPP
// @version         0.0.2 beta
// @description     SG++ for Steamgifts.com
// @author          faragona
// @match           http://www.steamgifts.com/*
// @run-at          document-end
// @downloadURL     https://raw.githubusercontent.com/faragona/SGPP/master/SGPP.user.js
// @updateURL       https://raw.githubusercontent.com/faragona/SGPP/master/SGPP.meta.js
// @require         http://code.jquery.com/jquery-2.1.3.min.js
// @require         https://raw.githubusercontent.com/dinbror/bpopup/master/jquery.bpopup.min.js
// @resource head   https://raw.githubusercontent.com/faragona/SGPPSettings/0.4.0/head.html
// @resource settings   https://raw.githubusercontent.com/faragona/SGPPSettings/0.4.0/settings.html
// @grant           GM_addStyle
// @grant           GM_getResourceText
// @grant           GM_xmlhttpRequest
// ==/UserScript==
var ModuleDefinition;!function(e){var t=function(){function e(){var e=this;this._LSPrefix="SGPP_",this.containsItem=function(t){return null!=localStorage.getItem(e._LSPrefix+t)},this.getItem=function(t,n){return JSON.parse(localStorage.getItem(e._LSPrefix+t)||null)||n},this.setItem=function(t,n){localStorage.setItem(e._LSPrefix+t,JSON.stringify(n))},this.clear=function(){SGPP.log("Removing all SGPP entries from LocalStorage."),Object.keys(localStorage).forEach(function(t){0==t.indexOf(e._LSPrefix)&&localStorage.removeItem(t)})}}return e}();e.LocalStorage=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function t(){var t=this;this._debug=!0,this._settings=new e.Settings,this._storage=new e.LocalStorage,this.modules={},this.log=function(e){t._debug&&console.log("["+new Date+"] SGPP - "+e)},this.appendCSS=function(e){t._styleSheet.append(e)},this.on=function(e,n,i){if("string"==typeof e)t.addOnCallbackHelper(e,n,i);else for(var a in e)t.addOnCallbackHelper(e[a],n,i)},this.addGiveawayFilter=function(e){return"GiveawaysFilter"in SGPP.modules?(SGPP.modules.GiveawaysFilter.addFilter(e),!0):!1},this.style="",this.init=function(){t.log("Steamgifts++ plugin started.");var e=$('.nav__button-container a[href^="/user/"]');e.length&&(t._currentUser=e.attr("href").substr("/user/".length)),t.resolvePath(),t._settings.init(t._storage),t._styleSheet=$(document.createElement("style")).attr("id","SGPP_StyleSheet").appendTo("head"),t.appendCSS("/* SGPP Stylesheet */ "),t.appendCSS(t._settings.style)},this.resolvePath=function(){var e="",n="",i="",a="",o="",s=window.location;if(s.hash.length>1&&(e=s.hash.substring(1)),"/"==s.pathname)n="giveaways";else{var r=s.pathname.split("/").filter(function(e,t,n){return Boolean(e)});n=r[0]||"",a=r[2]||"","giveaway"==r[0]||"trade"==r[0]||"discussion"==r[0]||"user"==r[0]||"group"==r[0]?(o=("search"==r[3]?"":r[3])||"",i=r[1]||""):o=r[1]||""}for(var l,d=/\+/g,p=/([^&=]+)=?([^&]*)/g,c=function(e){return decodeURIComponent(e.replace(d," "))},u=s.search.substring(1),g={};l=p.exec(u);)g[c(l[1])]=c(l[2]);t._sgLocation={pageKind:n,code:i,description:a,subpage:o,hash:e,parameters:g}},this.init()}return Object.defineProperty(t.prototype,"user",{get:function(){return this._currentUser},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"settings",{get:function(){return this._settings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return this._sgLocation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._storage},enumerable:!0,configurable:!0}),t.prototype.addOnCallbackHelper=function(e,t,n){e in SGPP.modules&&(SGPP.log("Handler attached on "+e+" ("+t+")"),$(SGPP.modules[e]).on(t,n))},t.prototype.name=function(){return"Core"},t.prototype.shouldRun=function(e){return!0},t.prototype.render=function(){this._settings.render()},t}();e.Core=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.id="HideEntered",this.settings={hideEntered:!1}}return e.prototype.renderControl=function(e){var t=this,n=$(e);this.element=$('<span><span class="fa fa-square-o"></span> <span class="filter-name">Hide Entered</span></span>'),this.element.click(function(){t.settings.hideEntered=!t.settings.hideEntered,t.updateElement(),$(t).trigger("filterChanged",[t.settings])}),this.updateElement(),n.append(this.element)},e.prototype.updateElement=function(){this.element&&this.element.find("span.fa").toggleClass("fa-square-o",!this.settings.hideEntered).toggleClass("fa-check-square",this.settings.hideEntered)},e.prototype.shouldHide=function(e){var t=$(e);return this.settings.hideEntered&&t.children(".giveaway__row-inner-wrap").hasClass("is-faded")},e.prototype.setState=function(e){this.settings=e,this.updateElement()},e}();e.HideEnteredFilter=t;var n=function(){function e(){this.style="#sidebar_sgpp_filters { color: #4B72D4; font-size: 11px; padding-bottom: 15px; }\n#sidebar_sgpp_filters .filter_row { cursor: pointer; padding: 2px; padding-left: 10px; }\n#sidebar_sgpp_filters .filter-name { font-weight: bold; } .giveaway-filtered { display:none; }",this.filters={}}return e.prototype.shouldRun=function(){return"giveaways"==SGPP.location.pageKind},e.prototype.init=function(){this.addFilter(new t)},e.prototype.addFilter=function(e){var t=this;this.filters[e.id]=e,$(e).on("filterChanged",function(n,i){t.filterGames(),SGPP.storage.setItem("giveaway_filter_"+e.id,i)}),SGPP.storage.containsItem("giveaway_filter_"+e.id)&&e.setState(SGPP.storage.getItem("giveaway_filter_"+e.id))},e.prototype.render=function(){var e=this;$(".sidebar__search-container").after('<div id="sidebar_sgpp_filters"></div>');var t=$("#sidebar_sgpp_filters");t.append('<h3 class="sidebar__heading">Filter Giveaways</h3>'),$.each(this.filters,function(e,n){var i=document.createElement("div"),a=$(i);a.addClass("filter_row"),n.renderControl(i),t.append(i)}),SGPP.on("EndlessScrollGiveaways","addItem",function(t,n){e.filterGame(n)}),this.filterGames()},e.prototype.filterGames=function(){var e=this;$(".giveaway__row-outer-wrap").each(function(t,n){e.filterGame(n)});var t=$(".pinned-giveaways__outer-wrap .giveaway__row-outer-wrap").length,n=$(".pinned-giveaways__outer-wrap .giveaway__row-outer-wrap.giveaway-filtered").length;t==n?$(".pinned-giveaways__outer-wrap").hide():$(".pinned-giveaways__outer-wrap").show()},e.prototype.filterGame=function(e){var t=!1,n=$(e);for(var i in this.filters){var a=this.filters[i];a.shouldHide(e)&&(t=!0)}n.toggleClass("giveaway-filtered",t)},e.prototype.name=function(){return"Giveaways Filter"},e}();e.GiveawaysFilter=n}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.shouldRun=function(e){return"giveaway"==e.pageKind&&""==e.subpage},this.style="div.SGPP_CommAndEnter {margin: 0 0 0 5px}\n",this.init=function(){},this.render=function(){var e=$(".sidebar .sidebar__entry-insert");if(0!==e.length){var t=$(".sidebar .sidebar__entry-delete"),n=$(".sidebar .sidebar__entry-loading"),i=$(".js__submit-form"),a=n.clone().addClass("SGPP_CommAndEnter").insertAfter(i),o=e.clone().addClass("SGPP_CommAndEnter").text("Submit + Enter").insertAfter(i),s=new MutationObserver(function(t){o.toggleClass("is-hidden",e.hasClass("is-hidden")),a.toggleClass("is-hidden",n.hasClass("is-hidden"))}),r={attributes:!0,attributeFilter:["class"]};s.observe(e[0],r),s.observe(n[0],r),o.click(function(n){e.click(),$("textarea.description").prop("disabled",!0);var a=new MutationObserver(function(e){t.hasClass("is-hidden")||(i.closest("input[name=do]").val("comment_new"),i.closest("form").submit())});a.observe(t[0],r)})}}}return e.prototype.name=function(){return"Comment and Enter on Giveaways"},e}();e.CommentAndEnter=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){var e=this;this.url="http://www.steamgifts.com/giveaway/",this.cacheCompleted=!1,this.isLoading=!1,this.commenters={},this.pageStart=1337,this.style=".SGPP_EntryComm {margin: 0 10px}\n.SGPP_EntryComm > i {margin: 0}\n.SGPP_EntryComm:not(.loading) > .fa-spin {display: none}\n.SGPP_EntryComm.loading > .fa-comments-o {display: none}\n.SGPP_EntryComm.active > .fa-comments-o {opacity: 0.7}\n.SGPP_EntryComm:hover > .fa-comments-o {opacity: 1}\nspan.SGPP_EntryComm_comment {vertical-align: inherit; text-shadow: none}\n.SGPP_EntryComm_disabled .SGPP_EntryComm_comment {visibility: hidden}\n.SGPP_EntryComm_comment > i.fa.fa-check, .SGPP_EntryComm_comment > i.fa.fa-times {font-size: 0.7em}\n.SGPP_EntryComm_comment > i.fa.fa-check {color: #719A47}\n.SGPP_EntryComm_comment > i.fa.fa-times {color: rgba(166, 93, 92, 0.85)}\n",this.render=function(){e.button.appendTo(".page__heading__breadcrumbs").one("click",e.firstRun)},this.firstRun=function(){if(!e.cacheCompleted)return e.isLoading||(e.button.addClass("loading"),e.isLoading=!0,e.getCommenters()),void setTimeout(e.firstRun,1e3);e.button.removeClass("loading"),$(".table__rows .table__column--width-fill > a").each(e.main),e.button.addClass("active"),e.button.click(e.toggleState);var t=new MutationObserver(function(t){for(var n=0;n<t.length;n++)$(".table__rows").toggleClass("SGPP_EntryComm_disabled",!e.button.hasClass("active")),$(t[n].addedNodes).find(".table__column--width-fill > a").each(e.main)});t.observe($(".table")[0],{childList:!0,subtree:!0})},this.toggleState=function(){e.button.toggleClass("active"),$(".table__rows").toggleClass("SGPP_EntryComm_disabled",!e.button.hasClass("active"))},this.main=function(t,n){var i=$("p.table__column__heading",n);i.length>0&&(n=i[0]),e.commenters[n.textContent.trim()]?e.elements.pos.clone().appendTo(n):e.elements.neg.clone().appendTo(n)},this.getCommenters=function(){e.url+=SGPP.location.code+"/"+SGPP.location.description+"/search?page=",e.page=e.pageStart,e.getCommentPage()},this.getCommentPage=function(){$.ajax({type:"GET",url:e.url+e.page,success:e.handleCommentPage})},this.handleCommentPage=function(t){var n=$(t);if($(".comments .comment__username",n).each(function(t,n){e.commenters[n.textContent.trim()]=!0}),e.page==e.pageStart){var i=$("a[data-page-number]",n);e.page=0!=i.length?i.last().data().pageNumber:1}--e.page>0?e.getCommentPage():e.cacheCompleted=!0}}return e.prototype.init=function(){var e=$(document.createElement("i")).addClass("giveaway__icon fa fa-comments-o").attr("title","Check who commented"),t=$(document.createElement("i")).addClass("giveaway__icon fa fa-refresh fa-spin").attr("title","Loading comments...").css("cursor","auto");this.button=$(document.createElement("span")).addClass("SGPP_EntryComm").append(e,t);var n=$(document.createElement("span")).addClass("SGPP_EntryComm_comment fa-stack").append($(document.createElement("i")).addClass("fa fa-comment-o fa-stack-1x")),i=$(document.createElement("i")).addClass("fa fa-check fa-stack-1x"),a=$(document.createElement("i")).addClass("fa fa-times fa-stack-1x");this.elements={pos:n.clone().addClass("positive").attr("title","Commented").append(i),neg:n.clone().addClass("negative").attr("title","Did not comment").append(a)}},e.prototype.name=function(){return"Checks if entries/winners commented on Giveaways"},e.prototype.shouldRun=function(e){return"giveaway"==e.pageKind&&("entries"==e.subpage||"winners"==e.subpage)},e}();e.EntryCommenters=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.style="body.SPGG_FixedNavbar {padding-top: 39px}\n.header.SPGG_FixedNavbar {position: fixed; top: 0px; width: 100%; z-index: 100}\n.comment__summary {margin-top: -44px !important; padding-top: 48px !important;}\n.comment__actions > div, .comment__actions__button {position: relative; z-index: 5;}\n.page__heading__breadcrumbs {z-index: 5;}\n.scroll {opacity:0.3}\n.header { transition: opacity 0.4s ease-in-out }",this.shouldRun=function(e){return!0}}return e.prototype.init=function(){},e.prototype.render=function(){$("body").addClass("SPGG_FixedNavbar"),$("header").addClass("SPGG_FixedNavbar")},e.prototype.name=function(){return"Fixed Navbar on top"},e}();e.FixedNavbar=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.style="body.SGPP_FixedFooter {padding-bottom: 45px}\n.footer__outer-wrap.SGPP_FixedFooter_outerWrap {padding: 15px 0px; z-index: 100; bottom: 0px; position: fixed; width: 100%; background: inherit}\n.footer__inner-wrap.SGPP_FixedFooter_innerWrap {margin: 0px 25px}\n",this.shouldRun=function(e){return!0}}return e.prototype.init=function(){},e.prototype.render=function(){$("body").addClass("SGPP_FixedFooter"),$(".footer__outer-wrap").addClass("SGPP_FixedFooter_outerWrap"),$(".footer__inner-wrap").addClass("SGPP_FixedFooter_innerWrap")},e.prototype.name=function(){return"Fixed Footer on bottom"},e}();e.FixedFooter=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){var e=this;this.shouldRun=function(e){return"giveaways"==e.pageKind&&-1==["created","entered","won"].indexOf(e.subpage)},this.style=".SGPP__gridView {display: flex; flex-wrap: wrap; justify-content: space-around; margin: 5px;}\n.tile_view_header {font-size: 12px; border-bottom: 1px solid #D2D6E0; box-shadow: 0px 1px 0px rgba(255, 255, 255, 0.3); margin-bottom: 3px; text-align: center}\n.SGPP__gridAvatar_outer {float: right; display: inline-block; margin-left: 5px}\n.SGPP__gridAvatar {height: 27px; width: 27px; padding: 2px}\n.SGPP__gridTile {margin: 5px}\n.SGPP__gridTile > .global__image-outer-wrap--game-medium {position: relative}\n.SGPP__gridTile:not(:hover) .SGPP__gridTileTime {display: none}\n.SGPP__gridTile:hover {opacity: 1}\n.SGPP__gridTile:hover > .global__image-outer-wrap--game-medium {border-radius: 4px 4px 0 0; border-bottom: 1px dotted transparent}\n.SGPP__gridTile:hover > .SGPP__gridTileInfo {display: block; border-radius: 0 0 4px 4px}\n.SGPP__gridTileInfo {display: none; position:absolute; width:184px; border-top: none; z-index: 10}\n.SGPP__gridTileInfo .giveaway__icon {opacity: 0.7}\n.SGPP__gridTileTime {position: absolute; bottom: 5px; left: 5px; height: 16px; text-align: center; background-color: #FFF; border-radius: 0 3px 0 0; padding: 2px 4px}\n.SGPP__gridTileTime i {font-size: inherit; color:inherit}\n.SGPP__gridTileIcons {position: absolute; bottom: 5px; right: 5px}\n.SGPP__gridTileIcons > * {display: inline-block; width: 20px; height: 16px; text-align: center; padding: 2px; border-radius: 3px 0 0; vertical-align: middle}\n.SGPP__gridTileIcons > :not(:last-child) {padding-right: 4px; margin-right: -3px}\n.SGPP__gridTileIcons i {font-size: inherit; color: inherit}\n",this.init=function(){},this.render=function(){var t=$(".pagination").prev();SGPP.on("EndlessScrollGiveaways","afterAddItems",function(t,n,i,a){e.updateGridview(n)}),e.updateGridview(t)},this.updateGridview=function(t){var n=t.children(".giveaway__row-outer-wrap");if(n.length){var i=$(document.createElement("div")).wrapInner(n),a=e.generateGridview(i);t.append(a)}},this.generateGridview=function(e){function t(e,t){var n=100*+(e/t);return.01>n?"<0.01":Math.min(n,100).toFixed(2)}var n=function(e){return"<strong>"+e+"</strong>"},i=function(e){return $("<div>",{style:"float: left",append:e})},a=function(e){return $("<div>",{style:"float: right",append:e})},o=$("<div>",{"class":"SGPP__gridView"}),s=$("<div>",{"class":"SGPP__gridTile"}),r=$("<h2>",{"class":"SGPP__gridTileInfo global__image-outer-wrap"}),l=$("<div>",{"class":"SGPP__gridTileIcons"});return e.find(".giveaway__row-inner-wrap").each(function(){var e=$(this);if(0==e.parents(".pinned-giveaways").length){var d=s.clone().toggleClass("is-faded",e.hasClass("is-faded")),p=e.children(".global__image-outer-wrap--game-medium").appendTo(d).css("position","relative"),c=e.find(".giveaway__columns").children(),u=c.eq(0).addClass("SGPP__gridTileTime").appendTo(p);u.find("span").text(function(e,t){return t.match(/\d+(?:\s+)./)[0].replace(" ","")});var g=c.slice(2);g.length>0&&(g.filter(".giveaway__column--contributor-level").text(function(e,t){return t.replace("Level ","")}),l.clone().append(g).appendTo(p));var f=e.find(".giveaway__heading__name").text(),h=e.find(".global__image-outer-wrap--avatar-small").addClass("SGPP__gridAvatar"),_=e.find(".giveaway__heading__thin").toArray(),m=parseInt(_.pop().textContent.replace(/\D+/g,"")),P=0==_.length?1:parseInt(_.pop().textContent.replace(/\D+/g,"")),v=e.find(".giveaway__links").children(),y=parseInt(v.eq(0).text().replace(/\D+/g,"")),b=parseInt(v.eq(1).text().replace(/\D+/g,"")),w=t(P,y);r.clone().append($("<div>",{text:f,"class":"giveaway__heading__name tile_view_header"}),$("<div>",{"class":"SGPP__gridAvatar_outer",title:"Created "+c.eq(1).text(),append:h}),$("<div>",{style:"display: inline-block; width: 145px"}).append(i(n(P)+(P>1?" Copies":" Copy")),a(n(m+"P")),$("<div>",{style:"clear: both"}),i(n(w+"%")).attr("title","Probability to win"),a(e.find(".giveaway__icon"))),$("<div>",{style:"clear: both"}),i(n(y)+" Entries"),a(n(b)+" Comments")).appendTo(d),o.append(d)}}),o}}return e.prototype.name=function(){return"GridView"},e}();e.GridView=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.style="",this.shouldRun=function(e){return!1}}return e.prototype.init=function(){},e.prototype.render=function(){},e.prototype.name=function(){return"LivePreview"},e}();e.LivePreview=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.style="",this.shouldRun=function(e){return!0}}return e.prototype.init=function(){},e.prototype.render=function(){var e=$(".sidebar"),t=$(document.createElement("div")).addClass(e.attr("class")),n=e.wrapInner(t).children().first().addClass("SGPP__scrollingSidebar"),i=e.find(".adsbygoogle"),a=function(){var e;return function(t){clearTimeout(e),e=setTimeout(function(){t?i.stop().slideUp():i.stop().slideDown()},250)}}(),o=$(window),s=$(".footer__outer-wrap").outerHeight(),r=$(".page__inner-wrap .widget-container"),l=$(".featured__container").height(),d=25,p=0;void 0!==SGPP.modules.FixedNavbar?d+=$("header").outerHeight():p+=$("header").outerHeight();var c=function(){var e=o.scrollTop();e+n.height()>=r.position().top+r.height()?(n.css({position:"fixed",top:"",bottom:s}),a(!0)):l+p>=e?(n.css({position:"static",top:"",left:""}),a(!1)):(n.css({position:"fixed",top:d,bottom:""}).show(),a(!0))};$(".featured__inner-wrap .global__image-outer-wrap img").on("load",function(){l=$(".featured__container").height(),c()}),c(),$(document).scroll(c)},e.prototype.name=function(){return"Scrolling Sidebar"},e}();e.ScrollingSidebar=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function t(){var t=this;this._lsSettings={},this.style=".SGPP__settings { cursor: pointer; }\n",this.settingsNavIcon='<a class="nav__row SGPP__settings" href="/sgpp">\n<i class="icon-red fa fa-fw fa-bars"> </i>\n<div class="nav__row__summary">\n<p class="nav__row__summary__name" > SG++ Settings</p>\n<p class="nav__row__summary__description"> Steamgifts++ settings.</p>\n</div>\n</a>\n',this.init=function(n){t._lsSettings=n.getItem(e.Settings.SETTINGS_KEY,{}),"/sgpp"==window.location.pathname&&(unsafeWindow.window.$=$,$("head").html(GM_getResourceText("head")),$("body").html(GM_getResourceText("settings")))},this.render=function(){"sgpp"!=SGPP.location.pageKind?$(".nav__absolute-dropdown a[href^='/?logout']").before(t.settingsNavIcon):($(".SGPP__form__checkbox").each(function(e,n){var i=$(n),a=i.attr("name");if(i.parent(".SGPP__Module").length)i.prop("checked",t.isModuleEnabled(a));else{var o=i.closest(".form__row").find(".SGPP__Module input").attr("name");i.prop("checked",t.getSettingForModule(o,a)||!1)}}),$(".SGPP__form__checkbox").on("click",function(e){var n=$(e.target),i=n.prop("checked");if(n.parent(".SGPP__Module").length){var a=n.attr("name");t._lsSettings.hasOwnProperty(a)?t._lsSettings[a].enabled=i:t._lsSettings[a]={enabled:i}}else{var a=n.closest(".form__row").find(".SGPP__Module input").attr("name"),o=n.attr("name");t._lsSettings.hasOwnProperty(a)||(t._lsSettings[a]={enabled:!1}),t._lsSettings[a][o]=i}t.persistSettings()}))},this.shouldRun=function(e){return!0},this.isModuleEnabled=function(e){return t._lsSettings.hasOwnProperty(e)&&t._lsSettings[e].enabled},this.getSettingForModule=function(e,n){return t._lsSettings.hasOwnProperty(e)?t._lsSettings[e][n]:null},this.persistSettings=function(){SGPP.storage.setItem(e.Settings.SETTINGS_KEY,t._lsSettings)}}return t.prototype.name=function(){return"Settings"},t.SETTINGS_KEY="Settings",t}();e.Settings=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.style='.SGPP_UserInfo_balloon {position: absolute; border: solid 2px black; z-index: 99; min-width: 200px; border-radius: 3px; min-height: 100px; background-color: inherit}\n.SGPP_UserInfo_balloon:after {position: absolute; right: 100%; top: 5px; content: ""; height: 0; width: 0; border-style: solid; border-color: transparent black; border-width: 15px 20px 15px 0px}\n.SGPP_UserInfo_balloon.right:after {right: -20px; border-width: 15px 0 15px 20px}\n.SGPP_UserInfo_balloon .featured__outer-wrap.featured__outer-wrap--user {width: auto; padding: 15px 0}\n.SGPP_UserInfo_balloon .featured__heading i {font-size: inherit}\n.SGPP_UserInfo_balloon .featured__table__column {width: 175px}\n.SGPP_UserInfo_balloon .featured__table .featured__table__row {padding: 5px 0px}\n.SGPP_UserInfo_balloon .featured__table__column:not(:first-child) {margin-left: 15px}\n.SGPP_UserInfo_balloon .featured__outer-wrap .global__image-outer-wrap {float: left; margin: 10px 7px 0px 0px; padding: 2px; width: 48px; height: 48px}\n.SGPP_UserInfo_balloon .SGPP_UserOnline {background: linear-gradient(to bottom, #8FB93B 5%, #6E8C31 95%) repeat scroll 0% 0% transparent}\n.SGPP_UserInfo_balloon .SGPP_UserOffline {background: linear-gradient(to bottom, rgba(106, 106, 106, 0.45) 5%, rgba(85, 85, 85, 1) 95%) repeat scroll 0% 0% transparent}\n.SGPP_UserInfo_balloon .sidebar__shortcut-inner-wrap {width: 130px; color: rgba(255, 255, 255, 0.4)}\n.SGPP_UserInfo_balloon .sidebar__shortcut-inner-wrap > * {line-height: 10px; text-shadow: none; background: none; border: none}\n.SGPP_UserInfo_balloon .sidebar__shortcut-inner-wrap > .is-selected, .SGPP_UserInfo_balloon .sidebar__shortcut-inner-wrap > :hover, .SGPP_UserInfo_balloon .sidebar__shortcut-inner-wrap > :active {background: none; text-shadow: none; box-shadow: none}\n',this.shouldRun=function(e){return!0}}return e.prototype.init=function(){},e.prototype.render=function(){function e(e){var t=$(".featured__outer-wrap.featured__outer-wrap--user",e),n=$(".featured__table__row",t),i=$(".featured__heading",t).css("display","block"),a=$(".global__image-outer-wrap",t).prependTo(i),o=n.eq(1).children().last().text().trim();o.toLowerCase().indexOf("online")>-1?a.attr("title",o).addClass("SGPP_UserOnline"):a.attr("title","Online "+o).addClass("SGPP_UserOffline"),n.eq(1).remove();var s=n.last().children().last();s[0].title="Contributor Value: "+$("span",s)[0].title,$("span",s).removeAttr("title"),s.appendTo(i),n.last().remove();var r=$(".sidebar__shortcut-inner-wrap",e).insertAfter(s);r.children().eq(2).click(function(){$(this).find("form").submit()});var l=$(".sidebar__suspension",e);return l.length>0&&$("<span>",{style:"color: #B16C86",text:" ("+l.text().trim()+")",title:$(".sidebar__suspension-time",e).text()}).appendTo(n.eq(0).children().last()),t}var t=$("<div>",{id:"SGPP_UserInfo_balloon","class":"SGPP_UserInfo_balloon"}).appendTo("body").hide(),n={},i=$("<div>",{style:"color: black"}).append($("<i>",{"class":"fa fa-refresh fa-spin fa-4x",style:"margin: 30px 80px; font-size: 4em; color: #6B7A8C"}));t.append(i),t.hover(function(){t.stop(!0).fadeIn("fast")},function(){a.close()});var a={timeout:null,run:function(a,o,s){clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.css(o),t.children().remove(),s?t.addClass("right"):t.removeClass("right");var r=a.match(/\/user\/(.+?)(?:\/|$)/)[1];void 0!==r&&r in n?t.append(n[r]).stop(!0).show():(t.append(i).stop(!0).show(),$.ajax({url:a,type:"GET",dataType:"html",success:function(i){var a=e(i).data("user",r);n[r]=a,t.children().remove(),t.append(a)}}))},500)},close:function(){clearTimeout(this.timeout),t.stop(!0).delay(200).fadeOut("slow")}};$(document).on({mouseenter:function(e){var t=$(e.target);if(!(t.attr("href").split("/").length>3||t.prop("href")==document.URL)){var n,i=t.offset(),o=$(window).width(),s=e.target.getBoundingClientRect().left>o/2;n=s?{top:i.top+t.height()/2-25,right:o-i.left+20,left:""}:{top:i.top+t.height()/2-25,right:"",left:i.left+t.width()+20},a.run(t.attr("href"),n,s)}},mouseleave:function(){a.close()}},'a[href^="/user/"]:not(.nav__avatar-outer-wrap)')},e.prototype.name=function(){return"Show User Profile on Hover"},e}();e.UserHoverInfo=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(e){var t=this;this.background=$("<div>",{"class":"SGPP__tagModal_background"}).appendTo("body"),this.content=$("<div>",{"class":"SGPP__tagModal popup"}).appendTo("body"),this.config=[],this.update=function(e,n){t.$name.text(e);for(var i=0;i<t.config.length;i++)t.config[i].val(n[i]);return t},this.show=function(){return t.background.show(),t.content.show(),t},this.hide=function(){return t.background.hide(),t.content.hide(),t},this.save=function(){for(var e=[],n=0;n<t.config.length;n++)e.push(t.config[n].val());return t.callback(t.$name.text(),e),t.hide()},this.callback=e,$("<i>",{"class":"popup__icon fa fa-tag"}).appendTo(this.content),$("<p>",{"class":"popup__heading",append:["Edit custom tag for ",this.$name=$("<span>",{"class":"popup__heading__bold"}),":"]}).appendTo(this.content);for(var n=$("<div>",{"class":"SGPP__tagOptions"}).appendTo(this.content),i=function(e,n){var i=$("<input>",{type:n});return t.config.push(i),$("<div>").append($("<span>",{"class":"form__heading__text",text:e}),i)},a=[["Tag text","text"],["Background color","color"],["Text color","color"]],o=0;o<a.length;o++)n.append(i(a[o][0],a[o][1]));$("<div>",{"class":"popup__actions"}).appendTo(this.content).append($("<span>",{text:"save",click:this.save}),$("<span>",{text:"cancel",click:this.hide})),this.background.click(this.hide),this.hide()}return e}(),n=function(){function e(){var e=this;this.style='.SGPP__tagIcon {margin-left: 5px; transform: rotate(-45deg); opacity: 0.35; cursor: pointer; text-shadow: none}\n.SGPP__tagIcon:hover {opacity: 0.7}\n.comment__username--op .SGPP__tagIcon {color: #FFF}\n.SGPP__userTag {display: inline-block; color: #465670; background-color: #FFF; font-weight: initial; text-shadow: none; padding: 0 4px; border-radius: 3px; border: 1px solid #D2D6E0; line-height: normal; margin-left: 5px; cursor: pointer}\n.SGPP__tagModal_background {position: fixed; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(60, 66, 77, 0.85); cursor: pointer; z-index: 9998}\n.SGPP__tagModal {display: block; position: fixed; top: 50px; left: 50%; width: 300px; margin-left: -250px; z-index: 9999}\n.SGPP__tagModal .popup__icon {width: 48px; text-indent: 5px}\n.SGPP__tagOptions {margin-bottom: 15px}\n.SGPP__tagOptions > div {display: flex; justify-content: space-between}\n.SGPP__tagOptions > div > input {width: 125px; height: 30px;}\n.SGPP__tagOptions > div :not(:first-child) { margin-top: 5px;}\n.SGPP__tagOptions .popup__actions {margin-top: 15px}\n.SGPP__tagOptions > div > span { line-height: 35px;}\n.SGPP__tagOptions > div > input[type="color"] { padding: 3px 6px;}\n',this.render=function(){e.tagConfigModal=new t(e.updateTags);var n=$('a[href^="/user/"]:not(.global__image-outer-wrap, .nav__avatar-outer-wrap)');e.usertagsCache=SGPP.storage.getItem("createdTags",{}),n.each(function(t,n){var i=$(n).prop("pathname").split("/"),a=n.textContent.trim();3==i.length&&i[2]==a&&e.createTag(a).insertAfter(n)}),$("body").on("click",".SGPP__tagIcon, .SGPP__userTag",function(t){var n=$(t.target).siblings('a[href^="/user/"]').text();if(n in e.usertagsCache)var i=e.usertagsCache[n];else var i=["","#FFFFFF","#465670"];e.tagConfigModal.update(n,i).show()})},this.shouldRun=function(e){return["about","sales","legal","roles"].indexOf(e.pageKind)<0},this.createTag=function(t){if(t in e.usertagsCache){var n=e.usertagsCache[t];return $("<div>",{text:n[0],"class":"SGPP__userTag",css:{backgroundColor:n[1],color:n[2]}})}return $("<i>",{"class":"fa fa-tag SGPP__tagIcon"})},this.updateTags=function(t,n){""===n[0]?delete e.usertagsCache[t]:e.usertagsCache[t]=n,SGPP.storage.setItem("createdTags",e.usertagsCache),console.log(1,t),$('a[href="/user/'+t+'"]').each(function(n,i){var a=$(i).siblings(".SGPP__userTag, .SGPP__tagIcon");0!==a.length&&(a.remove(),e.createTag(t).insertAfter(i))})}}return e.prototype.init=function(){},e.prototype.name=function(){return"Custom Tags to Users"},e}();e.UserTags=n}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(e){this._isDataStored=!1,this.localStorageKey="endless_scroll_"+e,this.localStorageKey in localStorage?(this._obj=JSON.parse(localStorage[this.localStorageKey]),"numberOfComments"in this._obj||(this._obj.numberOfComments=0),"lastSeenPage"in this._obj||(this._obj.lastSeenPage=0),"collapsed"in this._obj||(this._obj.collapsed={}),this._isDataStored=!0):this._obj={lastVisit:Date.now(),lastCommentIDPages:{},collapsed:{},numberOfComments:0}}return Object.defineProperty(e.prototype,"isDataStored",{get:function(){return this._isDataStored},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastVisit",{get:function(){return this._obj.lastVisit},enumerable:!0,configurable:!0}),e.prototype.getNumComments=function(){return this._obj.numberOfComments},e.prototype.setCommentState=function(e,t){t?this._obj.collapsed[e]=1:delete this._obj.collapsed[e],this.save()},e.prototype.getCommentState=function(e){return e in this._obj.collapsed},e.prototype.setLastVisit=function(){this._obj.lastVisit=Date.now(),this.save()},e.prototype.setLastSeenPage=function(e){this._obj.lastSeenPage=e,this.save()},e.prototype.setLastCommentID=function(e,t,n){this._obj.lastCommentIDPages[e]=t,this._obj.numberOfComments=n,this.save()},e.prototype.isNewComment=function(e,t){return e in this._obj.lastCommentIDPages?t>this._obj.lastCommentIDPages[e]:!0},e.prototype.forget=function(){this.localStorageKey in localStorage&&localStorage.removeItem(this.localStorageKey)},e.prototype.save=function(){localStorage[this.localStorageKey]=JSON.stringify(this._obj)},e}(),n=function(){function e(){this.style=".endless_new .comment__parent .comment__summary, .endless_new > .comment__child{}.endless_not_new .comment__parent .comment__summary, .endless_not_new > .comment__child{}.endless_not_new:hover .comment__parent .comment__summary, .endless_not_new:hover > .comment__child{}.endless_badge_new, .endless_badge_new_child {border-radius: 4px; margin-left:5px; padding: 3px 5px; background-color: #C50000;text-shadow: none;color: white; font-weight: bold;}.endless_badge_new_child { display: none; }.comment--collapsed .endless_badge_new_child { display: block; }\n.table__row-outer-wrap .markcomments_controls { display: none; }\n.table__row-outer-wrap:hover .markcomments_controls { display: inline; }.markcomments_controls i { opacity: 0.5; cursor: pointer; }\n.markcomments_controls i:hover { opacity: 1; }"}return Object.defineProperty(e.prototype,"topic",{get:function(){return this.topicInfo},enumerable:!0,configurable:!0}),e.prototype.getDiscussionId=function(e){var t=/(discussion|trade)\/([^\/]+)(\/|$)/.exec(e);if(!t)throw"No Discussion ID";return t[1]+"_"+t[2]},e.prototype.getLatestCommentID=function(e){var t=0;return $(e).find(".comment[data-comment-id]").each(function(e,n){var i=parseInt($(n).data("comment-id"));i>t&&(t=i)}),t},e.prototype.shouldRun=function(){return!0},e.prototype.init=function(){},e.prototype.render=function(){var e=this;if("discussion"==SGPP.location.pageKind||"trade"==SGPP.location.pageKind){this.topicInfo=new t(this.getDiscussionId(location.pathname));var n=1,i=$("div.pagination__navigation a.is-selected");0!=i.length&&(n=i.first().data("page-number")),this.markComments($(document),n,!0),this.topicInfo.setLastVisit();var a=this;$("body").on("click",".comment__collapse-button",function(){var e=$(this),t=e.parents(".comment"),n=parseInt(t.data("comment-id"));a.topicInfo.setCommentState(n,!0)}),$("body").on("click",".comment__expand-button",function(){var e=$(this),t=e.parents(".comment"),n=parseInt(t.data("comment-id"));a.topicInfo.setCommentState(n,!1)}),SGPP.on("EndlessScrollDiscussionReplies","beforeAddItems",function(t,n,i,a){e.markComments(n,i,!0,a)})}else if("discussions"==SGPP.location.pageKind||"trades"==SGPP.location.pageKind){this.markTopics($(document));var a=this;$("body").on("click",".markcomments_forget",function(){
var e=$(this),n=e.parents("h3"),i=n.children("a"),o=new t(a.getDiscussionId(i.attr("href")));o.forget(),n.find(".endless_badge_new").remove(),e.remove()}),SGPP.on("EndlessScrollDiscussion","beforeAddItems",function(t,n,i,a){e.markTopics(n)})}else"giveaways"==SGPP.location.pageKind&&""==SGPP.location.subpage&&this.markTopics($(".widget-container").last().prev().prev())},e.prototype.checkNewComments=function(e,t){var n=this,i=!1;return $(e).find(".comment[data-comment-id]").each(function(e,a){var o=parseInt($(a).data("comment-id"));n.topicInfo.isNewComment(t,o)&&(i=!0)}),i},e.prototype.markComments=function(e,t,n,i){var a=this;if(void 0===n&&(n=!1),void 0===i&&(i=!1),(this.topicInfo.isDataStored||i)&&e.find(".comment[data-comment-id]").each(function(e,n){var i=parseInt($(n).data("comment-id")),o=a.topicInfo.isNewComment(t,i),s=a.topicInfo.getCommentState(i);s&&$(n).addClass("comment--collapsed"),o?($(n).addClass("endless_new"),$(n).find(".comment__username").first().after($("<span>").addClass("endless_badge_new").text("New").attr("title","New since last visit"))):$(n).addClass("endless_not_new"),a.checkNewComments(n,t)?(o||$(n).find(".comment__username").first().after($("<span>").addClass("endless_badge_new_child").text("New replies").attr("title","New since last visit")),$(n).addClass("endless_new_children")):$(n).addClass("endless_no_new_children")}),n){var o=parseInt($(".comments:eq(1)").prev().find("a").text().split(" ")[0].replace(",",""));this.topicInfo.setLastCommentID(t,this.getLatestCommentID(e),o)}},e.prototype.markTopics=function(e){var n=this;e.find(".table__row-outer-wrap").each(function(e,i){try{var a=$(i).find("h3 a").first(),o=new t(n.getDiscussionId(a.attr("href")));if(SGPP.settings.getSettingForModule("EndlessScrollDiscussionReplies","reversedDiscussionReplies")&&a.attr("href",a.attr("href")+"/search?page=31337"),o.isDataStored){var s=parseInt($(i).find(".table__column--width-small a.table__column__secondary-link").text().replace(",","")),r=o.getNumComments(),l=s-r;l>0?($(i).addClass("endless_new_comments"),a.after($("<span>").addClass("endless_badge_new").text(l).attr("title",l+" new comments since last visit"))):($(i).addClass("endless_no_new_comments"),$(i).find(".table__column--width-fill > p").first().append(" - no new comments</strong>")),$(i).find("h3").first().append('<span class="markcomments_controls pull-right"><i class="fa fa-remove markcomments_forget" title="Forget this topic"></i></span>')}}catch(d){}})},e.prototype.name=function(){return"Mark Comments"},e}();e.MarkComments=n}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(e){this.id="HideIgnored",this.settings={hide:!1},this.module=e}return e.prototype.renderControl=function(e){var t=this,n=$(e);this.element=$('<span><span class="fa fa-square-o"></span> <span class="filter-name">Hide Not Interested</span></span>'),this.element.click(function(){t.settings.hide=!t.settings.hide,t.updateElement(),$(t).trigger("filterChanged",[t.settings])}),this.updateElement(),n.append(this.element)},e.prototype.updateElement=function(){this.element&&this.element.find("span.fa").toggleClass("fa-square-o",!this.settings.hide).toggleClass("fa-check-square",this.settings.hide)},e.prototype.shouldHide=function(e){var t=$(e),n=t.find("a.giveaway__icon").attr("href");return this.module.parseAppLink(n),this.settings.hide&&this.module.ignores(n)},e.prototype.setState=function(e){this.settings=e,this.updateElement()},e}();e.HideIgnored=t;var n=function(){function e(e){this.id="HideOwned",this.settings={hide:!1},this.module=e}return e.prototype.renderControl=function(e){var t=this,n=$(e);this.element=$('<span><span class="fa fa-square-o"></span> <span class="filter-name">Hide Owned</span></span>'),this.element.click(function(){t.settings.hide=!t.settings.hide,t.updateElement(),$(t).trigger("filterChanged",[t.settings])}),this.updateElement(),n.append(this.element)},e.prototype.updateElement=function(){this.element&&this.element.find("span.fa").toggleClass("fa-square-o",!this.settings.hide).toggleClass("fa-check-square",this.settings.hide)},e.prototype.shouldHide=function(e){var t=$(e),n=t.find("a.giveaway__icon").attr("href");return this.module.parseAppLink(n),this.settings.hide&&this.module.owns(n)},e.prototype.setState=function(e){this.settings=e,this.updateElement()},e}();e.HideOwned=n;var i=function(){function e(e){this.id="HighlightWishlist",this.settings={highlight:!1},this.module=e}return e.prototype.renderControl=function(e){var t=this,n=$(e);this.element=$('<span><span class="fa fa-square-o"></span> <span class="filter-name">Show only wishlisted</span></span>'),this.element.click(function(){t.settings.highlight=!t.settings.highlight,t.updateElement(),$(t).trigger("filterChanged",[t.settings])}),this.updateElement(),n.append(this.element)},e.prototype.updateElement=function(){this.element&&this.element.find("span.fa").toggleClass("fa-square-o",!this.settings.highlight).toggleClass("fa-check-square",this.settings.highlight)},e.prototype.shouldHide=function(e){var t=$(e),n=t.find("a.giveaway__icon").attr("href");return this.settings.highlight&&!this.module.wishlisted(n,!1)},e.prototype.setState=function(e){this.settings=e,this.updateElement()},e}();e.HighlightWishlist=i;var a=function(){function e(){this.style='.wishlisted-giveaway .giveaway__heading__name, .wishlisted-giveaway .featured__heading__medium { background: url("data: image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAKCAYAAABi8KSDAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/ IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8 + IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTM3OEVDNTUyMUM0MTFFNDgxN0ZEN0MzNjYzNzcxOTYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTM3OEVDNTYyMUM0MTFFNDgxN0ZEN0MzNjYzNzcxOTYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMzc4RUM1MzIxQzQxMUU0ODE3RkQ3QzM2NjM3NzE5NiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMzc4RUM1NDIxQzQxMUU0ODE3RkQ3QzM2NjM3NzE5NiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI / Ps9jzFQAAACPSURBVHjaYvz//z+DkJDQdQYGhpsMCMAKxMZAHPXu3bt9cFGQYkFBwQ0gGoaBfAEgzgfibUDsBxNnYsAOfgKxJBBvAeIZMEEWZBVA52xA5gOdUAEUc8NQDBTkBEoGMOAByCYLAjUsRzM5AKtioMQzIEW0ydjcHIBTMSE3M0Ij5RKQfQ6HGiOgIXogBkCAAQDGVT+0v+n6EQAAAABJRU5ErkJggg==") no-repeat scroll 2px center; padding-left: 15px; }',this.userdata={rgWishlist:[],rgOwnedPackages:[],rgOwnedApps:[],rgPackagesInCart:[],rgAppsInCart:[],rgRecommendedTags:[],rgIgnoredApps:[],rgIgnoredPackages:[]},this.blacklistData={apps:[],subs:[]}}return e.prototype.shouldRun=function(){return!0},e.prototype.init=function(){SGPP.addGiveawayFilter(new t(this)),SGPP.addGiveawayFilter(new n(this)),SGPP.addGiveawayFilter(new i(this)),(!SGPP.storage.containsItem("steam_userdata")||!SGPP.storage.containsItem("steam_userdata_date")||SGPP.storage.getItem("steam_userdata_date")<Date.now()-432e5)&&this.refreshGamesFromSteam(),(!SGPP.storage.containsItem("blacklist_data")||!SGPP.storage.containsItem("blacklist_date")||SGPP.storage.getItem("blacklist_date")<Date.now()-432e5)&&this.refreshBlacklistFromSG(),SGPP.storage.containsItem("steam_userdata")&&(this.userdata=SGPP.storage.getItem("steam_userdata")),SGPP.storage.containsItem("steam_userdata")&&(this.blacklistData=SGPP.storage.getItem("blacklist_data"))},e.prototype.owns=function(e){var t=this.parseAppLink(e);return t?"app"==t[0]?this.ownsApp(t[1]):"sub"==t[0]?this.ownsApp(t[1]):void 0:null},e.prototype.ownsApp=function(e){return-1!==this.userdata.rgOwnedApps.indexOf(e)},e.prototype.ownsPackage=function(e){return-1!==this.userdata.rgOwnedPackages.indexOf(e)},e.prototype.ignores=function(e){var t=this.parseAppLink(e);return t?"app"==t[0]?this.ignoresApp(t[1]):"sub"==t[0]?this.ignoresPackage(t[1]):void 0:!1},e.prototype.blacklisted=function(e){var t=this.parseAppLink(e);return t?"app"==t[0]?this.blacklistedApp(t[1]):"sub"==t[0]?this.blacklistedSub(t[1]):void 0:!1},e.prototype.blacklistedApp=function(e){return-1!==this.blacklistData.apps.indexOf(e)},e.prototype.blacklistedSub=function(e){return-1!==this.blacklistData.subs.indexOf(e)},e.prototype.ignoresApp=function(e){return-1!==this.userdata.rgIgnoredApps.indexOf(e)},e.prototype.ignoresPackage=function(e){return-1!==this.userdata.rgIgnoredPackages.indexOf(e)},e.prototype.wishlisted=function(e,t){void 0===t&&(t=!0);var n=this.parseAppLink(e);return n?"app"==n[0]?this.isWishlisted(n[1]):"sub"==n[0]?!t:void 0:!1},e.prototype.isWishlisted=function(e){return-1!==this.userdata.rgWishlist.indexOf(e)},e.prototype.parseAppLink=function(e){if(!e)return!1;var t=e.match(/\/(app|sub)\/(\d+)\//);return t?[t[1],parseInt(t[2])]:!1},e.prototype.render=function(){var e=this;if("giveaway"==SGPP.location.pageKind){var t=$("a.global__image-outer-wrap--game-large").first().attr("href"),n=!1,i=!1,a=!1,o=!1,s=this.parseAppLink(t);s&&(n=this.owns(t),i=this.ignores(t),a=this.blacklisted(t),o=this.wishlisted(t)),$(".sidebar").last(),n&&0!=$(".sidebar__entry-insert").length&&($(".sidebar__entry-insert").before('<div class="sidebar__ignored sidebar__error"><i class="fa fa-exclamation-circle"></i> Owned in Steam</div>'),$(".sidebar__entry-insert").hide()),i&&0!=$(".sidebar__entry-insert").length&&($(".sidebar__entry-insert").before('<div class="sidebar__ignored sidebar__error"><i class="fa fa-exclamation-circle"></i> Not Interested</div>'),$(".sidebar__entry-insert").hide()),a&&0!=$(".sidebar__entry-insert").length&&($(".sidebar__entry-insert").before('<div class="sidebar__ignored sidebar__error"><i class="fa fa-exclamation-circle"></i> Game Hidden</div>'),$(".sidebar__entry-insert").hide()),o&&$("div.featured__summary").addClass("wishlisted-giveaway"),$(".sidebar__ignored").click(function(){$(".sidebar__entry-insert").show(),$(".sidebar__ignored").hide()})}else"giveaways"==SGPP.location.pageKind&&(this.markGames(),SGPP.on("EndlessScrollGiveaways","addItem",function(t,n){e.markGame(n)}))},e.prototype.markGames=function(){var e=this;$(".giveaway__row-outer-wrap").each(function(t,n){e.markGame(n)})},e.prototype.markGame=function(e){var t=$(e),n=t.find("a.giveaway__icon").attr("href");t.toggleClass("wishlisted-giveaway",this.wishlisted(n))},e.prototype.refreshGamesFromSteam=function(){var e=this;GM_xmlhttpRequest({method:"GET",url:"http://store.steampowered.com/dynamicstore/userdata/",onload:function(t){var n=JSON.parse(t.responseText);0==n.rgOwnedApps.length&&alert("You are not logged in to Steam."),SGPP.storage.setItem("steam_userdata",n),SGPP.storage.setItem("steam_userdata_date",Date.now()),e.userdata=n}})},e.prototype.loadBlacklistPage=function(e,t,n){var i=this;$.get("http://www.steamgifts.com/account/settings/giveaways/filters/search?page="+e,function(a){var o=$($.parseHTML(a));$(o).find(".table__rows").children().each(function(e,t){console.log(t);var a=$(t),o=a.find("a.table__column__secondary-link");if(o.length){var s=i.parseAppLink(o.attr("href"));s&&("app"==s[0]?n.apps.push(s[1]):"sub"==s[0]&&n.subs.push(s[1]))}});var s=o.find(".pagination a").last();s.length&&e<parseInt(s.data("page-number"))?i.loadBlacklistPage(e+1,t,n):t(n)})},e.prototype.refreshBlacklistFromSG=function(){var e={apps:[],subs:[]};this.loadBlacklistPage(1,function(e){SGPP.storage.setItem("blacklist_data",e),SGPP.storage.setItem("blacklist_date",Date.now())},e)},e.prototype.name=function(){return"Filter Games"},e}();e.MarkOwnedGames=a}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this.style=".message_filter_hidden { display: none; }\n.message_filter_visible { }\n.filterdrop { position: absolute; }\n.filterdrop a { display: block; }\n.message-filters { margin-left: 5px; }\n.message-filter { cursor: pointer; }\n.message-filter i { margin: 0; }",this._hideRead=!1}return e.prototype.shouldRun=function(){return"discussion"==SGPP.location.pageKind||"trade"==SGPP.location.pageKind},Object.defineProperty(e.prototype,"hideRead",{get:function(){return this._hideRead},set:function(e){this._hideRead=e,this._filterElement.find(".hideread i").toggleClass("fa-square-o",!e).toggleClass("fa-check-square-o",e),this.filterAll()},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.filterItem=function(e){var t=$(e),n=!0,i=!t.hasClass("endless_not_new"),a=!t.hasClass("endless_no_new_children");this.hideRead&&(n=n&&(i||a)),t.toggleClass("message_filter_hidden",!n),t.toggleClass("message_filter_visible",n)},e.prototype.filterAll=function(){var e=this;$(".comment").each(function(t,n){e.filterItem(n)})},e.prototype.render=function(){var e=this;SGPP.on("EndlessScrollDiscussionReplies","addItem",function(t,n){e.filterItem(n)});var t=this;this._filterElement=$('<span class="message-filters"></span>'),this._filterElement.append('<span class="message-filter hideread"><i class="fa fa-square-o"></i> Hide Read</span>').click(function(){t.hideRead=!t.hideRead}),$(".comments:eq(1)").prev().find("div").append(this._filterElement),this.filterAll()},e.prototype.name=function(){return"Hide Read Comments"},e}();e.MessagesFilterTest=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){var e=this;this.style=".SGPP__popup_giveaway { text-align: justify; width: 90%; max-width: 1000px }\n.SGPP__popup_giveaway .page__outer-wrap { padding-top: 10px; padding-bottom: 10px; padding-left: 20px; padding-right:20px }\n.SGPP__popup_giveaway .comment__parent { margin-top: 10px }\n.SGPP__popup_giveaway .global__image-outer-wrap--avatar-small { margin-right: 5px }\n.SGPP__popup_giveaway .page__description { max-height: 200px; overflow-y: auto }\n.SGPP__popup_giveaway .markdown li { position:relative }\n.SGPP__popup_giveaway .featured__outer-wrap form > * { background-color: #f0f2f5 }\n.SGPP__popup_giveaway .featured__outer-wrap form { margin-top: 5px; }\n",this.popupGiveaway=$("<div>",{"class":"SGPP__popup_giveaway is-hidden"}),this.handlePopupCreate=function(t){$('a[href^="/giveaway/"]:not([href$="/entries"],[href$="/comments"],[href$="/winners"])',t).on("click",function(t){t.preventDefault(),e.handlePopup($(t.currentTarget))})},this.headingHelper=function(e){return'<div class="page__heading"><div class="page__heading__breadcrumbs">'+e+"</div></div>"},this.handlePopup=function(t){e.popupGiveaway.bPopup({onOpen:function(){e.popupGiveaway.removeClass("is-hidden"),$.ajax({url:t.attr("href")}).done(function(n){var i=$(".featured__outer-wrap",n);$(".featured__column--whitelist, .featured__column--group",i).each(function(){this.childNodes[1].nodeValue=""});var a=$("<div>",{"class":"page__outer-wrap"}),o=$(".sidebar form",n);o.length||(o=$(".sidebar__error",n));var s=$(".page__description",n),r=$(".comment--submit .comment__parent",n);r.find("span").addClass("b-close");var l=$(".js__submit-form",r);i.find(".featured__summary").append(o),s.length&&a.append(e.headingHelper("Description"),s),a.append(e.headingHelper("Reply"),r),e.popupGiveaway.append(i,a),e.popupGiveaway.css({top:Math.max(0,($(window).height()-(208+a.outerHeight()))/2+$(window).scrollTop())+"px"}),$(".sidebar__entry-insert, .sidebar__entry-delete",i).on("click",function(e){var n=$(e.currentTarget);n.addClass("is-hidden"),n.closest("form").find(".sidebar__entry-loading").removeClass("is-hidden"),n.closest("form").find("input[name=do]").val(n.attr("data-do")),$.ajax({url:"/ajax.php",type:"POST",dataType:"json",data:n.closest("form").serialize(),success:function(e){n.closest("form").find(".sidebar__entry-loading").addClass("is-hidden"),"success"===e.type?n.hasClass("sidebar__entry-insert")?(n.closest("form").find(".sidebar__entry-delete").removeClass("is-hidden"),t.closest(".giveaway__row-inner-wrap, .SGPP__gridTile").addClass("is-faded")):n.hasClass("sidebar__entry-delete")&&(n.closest("form").find(".sidebar__entry-insert").removeClass("is-hidden"),t.closest(".giveaway__row-inner-wrap, .SGPP__gridTile").removeClass("is-faded")):"error"===e.type&&n.closest("form").html("undefined"!=typeof e.link&&e.link!==!1?'<a href="'+e.link+'" class="sidebar__error"><i class="fa fa-exclamation-circle"></i> '+e.msg+"</a>":'<div class="sidebar__error is-disabled"><i class="fa fa-exclamation-circle"></i> '+e.msg+"</div>"),"undefined"!=typeof e.entry_count&&e.entry_count!==!1&&($(".live__entry-count").text(e.entry_count),$(".nav__points").text(e.points))}})}),l.on("click",function(e){e.preventDefault();var n=$(e.currentTarget);$.ajax({url:t.attr("href"),type:"POST",dataType:"json",data:n.closest("form").serialize(),complete:function(e){e.getResponseHeader("TM-finalURL")&&(n.closest("form").find("textarea").val(""),n.hide())}})})})},onClose:function(){e.popupGiveaway.addClass("is-hidden"),e.popupGiveaway.empty()},follow:[!0,!1]})},this.shouldRun=function(e){return"giveaways"==e.pageKind}}return e.prototype.init=function(){this.popupGiveaway.appendTo("body")},e.prototype.render=function(){var e=this;this.handlePopupCreate($(document)),SGPP.on(["EndlessScrollGiveaways","EndlessScrollLists"],"afterAddItems",function(t,n,i,a){e.handlePopupCreate(n)})},e.prototype.name=function(){return"Popup Giveaway"},e}();e.PopupGiveaway=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(){function e(){this._maxPage=31337,this._pageInView=-1,this._prevPage=-1,this._nextPage=-1,this._currentPage=1,this._lastPage=1,this._numberOfPages=-1,this._stopped=!1,this._pages={},this._pagesUrl={}}return Object.defineProperty(e.prototype,"stopped",{get:function(){return this._stopped},set:function(e){this._stopped=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentPage",{get:function(){return this._currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastPage",{get:function(){return this._numberOfPages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverseItems",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BaseUrl",{get:function(){throw"BaseUrl() not implmented"},enumerable:!0,configurable:!0}),e.prototype.hasPages=function(e){return 0!=$(e).find(".pagination__navigation").length},e.prototype.getNavigationElement=function(e){return $(e).find(".pagination").first()},e.prototype.createPageContainerElement=function(){throw"createPageContainerElement() not implemented"},e.prototype.getItemsElement=function(e){throw"getItemsElement() not implemented"},e.prototype.getItems=function(e){throw"getItems() not implemented"},e.prototype.createLoadingElement=function(){var e=$('<span class="endless_loading"> - <i class="fa fa-refresh fa-spin"></i> Loading...</span>');return e},e.prototype.createPageElement=function(e){var t=this,n=$('<div class="table__heading"><div class="table__column--width-fill"><p><span class="endless_page"></span></p></div></div>'),i=n.find("p");this.updatePageElement(n,e);var a=$("<div>").addClass("pull-right").addClass("endless_control_element"),o=$("<a>").attr("href","#").append('<i class="fa fa-refresh"></i>').attr("title","Reload this page"),s=$("<a>").attr("href","#").append('<i class="fa fa-pause pausecontrol"></i>').attr("title","Pause/Resume endless scrolling");return o.click(function(){return t.loadPage(e,!0),!1}),s.click(function(){return t.stopped=!t.stopped,$(".endless_control_element a i.pausecontrol").toggleClass("fa-pause",!t.stopped).toggleClass("fa-play",t.stopped),!1}),a.append(o),a.append(s),i.append(a),n},e.prototype.updatePageElement=function(e,t){var n="";n=t>0&&t<=this._maxPage?this._numberOfPages>0?"Page "+t+" of "+this._numberOfPages:"Page "+t:"Last page ends here",e.find(".endless_page").text(n)},e.prototype.loadNextPage=function(){this._stopped||this._nextPage>this._lastPage||this._nextPage<1||this.loadPage(this._nextPage)},e.prototype.updateNextPage=function(e){this.reverseItems?this._nextPage=e-1:this._nextPage=e+1,this.createPageContainer(this._nextPage)},e.prototype.updatePrevPage=function(e){this.reverseItems?this._prevPage=e+1:this._prevPage=e-1,this.createPageContainer(this._prevPage)},e.prototype.createPageContainer=function(e){if(!(e in this._pages)){if(1>e||e>this._lastPage)return;var t=-1,n=-1;$.each(this._pages,function(i,a){var o=Math.abs(i-e);(-1==n||t>o)&&(n=i,t=o)});var i=this.createPageContainerElement(),a=this.createPageElement(e);i.append(a),this._pages[e]={element:i,headerElement:a,loaded:!1,loading:!1,visible:!0};var o=this._pages[n].element;e>n&&!this.reverseItems||n>e&&this.reverseItems?o.after(i):o.before(i)}},e.prototype.loadPage=function(e,t){var n=this;if(void 0===t&&(t=!1),!(e in this._pagesUrl))throw"No URL for page "+this._currentPage;this.createPageContainer(e);var i=this._pages[e];if(!i.loading)if(i.loaded&&!t)i.visible||(i.element.show(),i.visible=!0),this._nextPage==e&&this.updateNextPage(e);else{var a=this._pagesUrl[e];this._pages[e].loading=!0;var o=this._pages[e].loaded,s=this._pages[e].element,r=this._pages[e].headerElement,l=this.createLoadingElement();r.find("p").first().append(l),o&&($(this).trigger("beforeReloadPage",[e]),s.children().remove(),this._pages[e].headerElement=r=this.createPageElement(e),s.prepend(r)),$.get(a,function(t){var i=$.parseHTML(t),a=n.getNavigationElement(i),d=parseInt(a.find("a.is-selected").data("page-number")),p=$(i);$(n).trigger("beforeAddItems",[p,d,o]);var c=n.getItemsElement(i);n.parseNavigation(a),n.addItems(c,s,d),s.prepend(r),n.getNavigationElement(document).html(a.html()),$(n).trigger("afterAddItems",[s,d,o]),n._pages[e].loading=!1,n._pages[e].loaded=!0,l.remove(),n._nextPage==e||-1==n._nextPage?n.updateNextPage(d):n._prevPage==e&&n.updatePrevPage(d),d!=e&&(n.updatePageElement(r,d),n._pages[d]=n._pages[e],delete n._pages[e]),n.updatePageInView()})}},e.prototype.addItems=function(e,t,n){var i=this;this.getItems(e).each(function(e,a){$(a).data("original-page",n),$(i).trigger("addItem",[a]),i.reverseItems?t.prepend(a):t.append(a)})},e.prototype.parseNavigation=function(e){var t=this,n=e.find("a").last();this._lastPage=parseInt(n.data("page-number")),"Next"!=n.text().trim()&&(this._numberOfPages=this._lastPage),e.find(".pagination__navigation a").each(function(e,n){var i=$(n),a=parseInt(i.data("page-number"));t._pagesUrl[a]=i.attr("href"),a>t._lastPage&&(t._lastPage=a)})},e.prototype.pushHistoryState=function(e){history.replaceState(null,null,this._pagesUrl[e])},e.prototype.updatePageInView=function(){var e=-1,t=-1;$.each(this._pages,function(n,i){var a=Math.abs($(window).scrollTop()-$(i.headerElement).offset().top);(-1==e||t>a)&&(e=n,t=a)}),-1==e&&(e=1),this._pageInView!=e&&(this._pageInView=e,console.log("page in view changed to "+e),this.pushHistoryState(e))},e.prototype.preparePage=function(){var e=this,t=this.getNavigationElement(document);if(!t.hasClass("pagination--no-results")){this.hasPages(document)?(this._currentPage=parseInt(t.find("a.is-selected").data("page-number")),this._pageInView=this._currentPage,this.parseNavigation(t)):(this._currentPage=1,this._lastPage=1,this._numberOfPages=1);var n=this.getItemsElement(document),i=this.createPageElement(this.currentPage),a=""!=SGPP.location.hash;if(this._pages[this.currentPage]={element:n,headerElement:i,loaded:!0,loading:!1,visible:!0},this.reverseItems?(this.getItems(n).each(function(e,t){n.prepend(t)}),1==this._currentPage&&this._numberOfPages>1&&!a?(this._nextPage=this._lastPage,this.loadNextPage(),this._pages[this.currentPage].visible=!1,n.hide()):1!=this._currentPage||-1!=this._numberOfPages||a?(this._prevPage=this.currentPage+1,this._nextPage=this.currentPage-1):(this._pagesUrl[this._maxPage]=this.BaseUrl+"/search?page="+this._maxPage,this._pages[this.currentPage].visible=!1,n.hide(),this.loadPage(this._maxPage))):(this._prevPage=this._currentPage-1,this._nextPage=this._currentPage+1),this._prevPage>0&&this.createPageContainer(this._prevPage),this.pushHistoryState(this.currentPage),this.createPageContainer(this._nextPage),n.prepend(i),a){var o=$("#"+SGPP.location.hash);$(window).scrollTop(o.offset().top)}$(window).scroll(function(t){e.updatePageInView();var n=$(window).scrollTop()+$(window).height();if(e._nextPage in e._pages){var i=e._pages[e._nextPage];n>$(i.headerElement).position().top-200&&e.loadNextPage()}}),$(window).scroll()}},e}();e.EndlessScroll=t}(ModuleDefinition||(ModuleDefinition={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},ModuleDefinition;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.style=""}return __extends(t,e),t.prototype.shouldRun=function(){return"discussions"==SGPP.location.pageKind||"trades"==SGPP.location.pageKind},t.prototype.init=function(){},t.prototype.render=function(){this.preparePage()},t.prototype.createPageContainerElement=function(){return $('<div class="table__rows">')},t.prototype.getItemsElement=function(e){return $(e).find(".table__rows").first()},t.prototype.getItems=function(e){return e.children(".table__row-outer-wrap")},t.prototype.name=function(){return"Endless Scroll on Discussions page"},t}(e.EndlessScroll);e.EndlessScrollDiscussion=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.style=""}return __extends(t,e),t.prototype.shouldRun=function(){return"discussion"==SGPP.location.pageKind||"trade"==SGPP.location.pageKind},t.prototype.init=function(){},t.prototype.render=function(){var e=$(".comment--submit").first();if(1==e.length){var t=$('<div id="esc_reply_header" class="page__heading"><div class="page__heading__breadcrumbs">Reply</div></div>');0==$(".poll").length?$(".comments").first().after(t):$(".poll").first().after(t),$("#esc_reply_header").after(e),$(".js__comment-reply-cancel").on("click",function(){setTimeout(function(){e.insertAfter("#esc_reply_header")},10)})}this.preparePage()},Object.defineProperty(t.prototype,"BaseUrl",{get:function(){return"/"+SGPP.location.pageKind+"/"+SGPP.location.code+"/"+SGPP.location.description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reverseItems",{get:function(){return SGPP.settings.getSettingForModule("EndlessScrollDiscussionReplies","reversedDiscussionReplies")||!1},enumerable:!0,configurable:!0}),t.prototype.createPageContainerElement=function(){return $('<div class="comments">')},t.prototype.getItemsElement=function(e){return $(e).find(".comments:eq(1)")},t.prototype.getItems=function(e){return e.children(".comment")},t.prototype.name=function(){return"Endless Scroll on Discussion comments"},t}(e.EndlessScroll);e.EndlessScrollDiscussionReplies=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.style=""}return __extends(t,e),t.prototype.shouldRun=function(){return"giveaway"==SGPP.location.pageKind&&""==SGPP.location.subpage},t.prototype.init=function(){},t.prototype.render=function(){var e=$(".comment--submit").first(),t=$('<div id="esc_reply_header" class="page__heading"><div class="page__heading__breadcrumbs">Reply</div></div>');$(".comments").prev().before(t),$("#esc_reply_header").after(e),$(".js__comment-reply-cancel").on("click",function(){setTimeout(function(){e.insertAfter("#esc_reply_header")},10)}),this.preparePage()},t.prototype.createPageContainerElement=function(){return $('<div class="comments">')},Object.defineProperty(t.prototype,"reverseItems",{get:function(){return SGPP.settings.getSettingForModule("EndlessScrollGiveawayComments","reversedGiveawayComments")||!1},enumerable:!0,configurable:!0}),t.prototype.getItemsElement=function(e){return $(e).find(".comments").first()},t.prototype.getItems=function(e){return e.children(".comment")},t.prototype.name=function(){return"Endless Scroll on Giveaway comments"},t}(e.EndlessScroll);e.EndlessScrollGiveawayComments=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(e){function t(){e.apply(this,arguments),this._location="frontpage",this.style=""}return __extends(t,e),t.prototype.shouldRun=function(){return"giveaways"==SGPP.location.pageKind?!("entered"==SGPP.location.subpage||"created"==SGPP.location.subpage||"won"==SGPP.location.subpage):/^\/user\/[^\/]+(\/giveaways\/won([^\/]+)?)?$/.test(location.pathname)?(this._location="profile",!0):!1},t.prototype.init=function(){},t.prototype.render=function(){var e=this;this.preparePage(),$(this).on("afterAddItems",function(e,t,n,i){t.find(".giveaway__hide").click(function(){$(".popup--hide-games input[name=game_id]").val($(this).attr("data-game-id")),$(".popup--hide-games .popup__heading__bold").text($(this).closest("h2").find(".giveaway__heading__name").text())}),t.find(".trigger-popup").click(function(){$("."+$(this).attr("data-popup")).bPopup({opacity:.85,fadeSpeed:200,followSpeed:500,modalColor:"#3c424d"})})}),$(".popup--hide-games .js__submit-form").after('<div class="form__submit-button ajax_submit-form"><i class="fa fa-check-circle"></i> Yes</div>'),$(".popup--hide-games .js__submit-form").hide(),$(".popup--hide-games .ajax_submit-form").click(function(t){var n=$(".popup--hide-games form").first();return $.post("/",n.serialize(),function(t){$(".popup--hide-games").bPopup().close(),e.hideGiveawaysByGameID($(".popup--hide-games input[name=game_id]").val())}),!1})},t.prototype.hideGiveawaysByGameID=function(e){$(".giveaway__row-outer-wrap").each(function(t,n){var i=$(n);i.find(".giveaway__hide").data("game-id")==e&&i.hide()})},t.prototype.createPageContainerElement=function(){return $("<div>")},t.prototype.getItemsElement=function(e){return $(e).find(".pagination").prev()},t.prototype.getItems=function(e){return e.children(".giveaway__row-outer-wrap")},t.prototype.name=function(){return"Endless Scroll on Giveaways"},t}(e.EndlessScroll);e.EndlessScrollGiveaways=t}(ModuleDefinition||(ModuleDefinition={}));var ModuleDefinition;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.style=""}return __extends(t,e),t.prototype.shouldRun=function(){return"giveaways"==SGPP.location.pageKind?"entered"==SGPP.location.subpage||"created"==SGPP.location.subpage||"won"==SGPP.location.subpage:"bundle-games"==SGPP.location.pageKind?!0:"giveaway"==SGPP.location.pageKind?"entries"==SGPP.location.subpage||"winners"==SGPP.location.subpage||"groups"==SGPP.location.subpage:"account"==SGPP.location.pageKind?"manage"==SGPP.location.subpage||"trades"==SGPP.location.subpage||"steam"==SGPP.location.subpage||"settings"==SGPP.location.subpage:!1},t.prototype.init=function(){},t.prototype.render=function(){this.preparePage()},t.prototype.createPageContainerElement=function(){return $('<div class="table__rows">')},t.prototype.getItemsElement=function(e){return $(e).find(".table__rows").first()},t.prototype.getItems=function(e){return e.children(".table__row-outer-wrap")},t.prototype.afterAddItems=function(e){$(e).find(".table__remove-default").click(function(){var e=$(this);e.addClass("is-hidden"),e.siblings(".table__remove-loading").removeClass("is-hidden"),$.ajax({url:"/ajax.php",type:"POST",dataType:"json",data:e.closest("form").serialize(),success:function(t){e.siblings(".table__remove-loading").addClass("is-hidden"),e.siblings(".table__remove-complete").removeClass("is-hidden"),e.closest(".table__row-inner-wrap").addClass("is-faded"),"undefined"!=typeof t.points&&t.points!==!1&&$(".nav__points").text(t.points)}})})},t.prototype.name=function(){return"Endless Scroll everywhere else"},t}(e.EndlessScroll);e.EndlessScrollLists=t;
}(ModuleDefinition||(ModuleDefinition={}));var SGPP=new ModuleDefinition.Core,modulesNames=new Array("GiveawaysFilter","CommentAndEnter","EntryCommenters","FixedNavbar","FixedFooter","GridView","ScrollingSidebar","UserHoverInfo","UserTags","MarkComments","MarkOwnedGames","MessagesFilterTest","PopupGiveaway","EndlessScrollDiscussion","EndlessScrollDiscussionReplies","EndlessScrollGiveaways","EndlessScrollGiveawayComments","EndlessScrollLists"),defaultModules={FixedNavbar:{enabled:!0},ScrollingSidebar:{enabled:!0}},currentVersion="0.3.0";!function(e){SGPP.storage.containsItem("Version")||(SGPP.storage.clear(),SGPP.storage.setItem("Version",currentVersion)),SGPP.storage.containsItem(ModuleDefinition.Settings.SETTINGS_KEY)||SGPP.storage.setItem(ModuleDefinition.Settings.SETTINGS_KEY,defaultModules);for(var t in modulesNames){var n=new ModuleDefinition[modulesNames[t]];SGPP.settings.isModuleEnabled(modulesNames[t])&&n.shouldRun(SGPP.location)&&(SGPP.modules[modulesNames[t]]=n)}for(var i in SGPP.modules)SGPP.log("Module "+i+" append css."),SGPP.appendCSS(SGPP.modules[i].style),SGPP.log("Module "+i+" init() call."),SGPP.modules[i].init();e(document).on("DOMContentLoaded",function(){SGPP.render();for(var e in SGPP.modules)SGPP.log("Module "+e+" render() call."),SGPP.modules[e].render()})}(jQuery),$(window).scroll(function(){$(window).scrollTop()>40?$("header").addClass("scroll"):$("header").removeClass("scroll")}),function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href","https://raw.githubusercontent.com/faragona/SGPP/master/custom.css")};